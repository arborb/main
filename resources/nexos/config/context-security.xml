<?xml version="1.0" encoding="UTF-8"?>
<!--
  //====================================================================================================================
  // 공통적으로 사용하는 Spring Root Context 설정 [보안 설정]
  // Author : ASETEC
  // Date : 2012-10-25
  // Description
  // Root Context 중에서 보안 설정 부분
  //====================================================================================================================
-->
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:security="http://www.springframework.org/schema/security"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context"
  xsi:schemaLocation="http://www.springframework.org/schema/beans
                      http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
                      http://www.springframework.org/schema/security
                      http://www.springframework.org/schema/security/spring-security-3.1.xsd
                      http://www.springframework.org/schema/context
                      http://www.springframework.org/schema/context/spring-context-3.1.xsd"
>
  <security:http auto-config="true" use-expressions="true">
    <security:intercept-url pattern="/**/*.gif" access="permitAll" />
    <security:intercept-url pattern="/**/*.png" access="permitAll" />
    <security:intercept-url pattern="/**/*.jpg" access="permitAll" />
    <security:intercept-url pattern="/**/*.ico" access="permitAll" />
    <security:intercept-url pattern="/**/*.css" access="permitAll" />
    <security:intercept-url pattern="/**/*.html" access="permitAll" />
    <security:intercept-url pattern="/**/*.js" access="permitAll" />
    <!-- <security:intercept-url pattern="/**/*.swf" access="permitAll" /> -->
    <!-- <security:intercept-url pattern="/index.html" access="permitAll" /> -->
    <!-- <security:intercept-url pattern="/nexos/html/common/js/misc/**/*.js" access="permitAll" /> -->
    <!-- <security:intercept-url pattern="/nexos/html/common/js/jquery/**/*.js" access="permitAll" /> -->
    <!-- <security:intercept-url pattern="/nexos/html/common/js/slickgrid/**/*.js" access="permitAll" /> -->
    <!-- <security:intercept-url pattern="/nexos/html/common/js/jwindow/**/*.js" access="permitAll" /> -->
    <!-- <security:intercept-url pattern="/nexos/html/common/js/*.js" access="permitAll" /> -->
    <!-- <security:intercept-url pattern="/nexos/html/main/**/*.html" access="permitAll" /> -->
    <!-- <security:intercept-url pattern="/nexos/html/main/**/*.js" access="permitAll" /> -->
    <!-- <security:intercept-url pattern="/**" access="permitAll" /> -->
    <!-- <security:intercept-url pattern="/**" access="hasRole('ROLE_USER')" /> -->
  </security:http>

  <!-- 보안처리를 위한 DAO 주입 -->
  <bean id="userDAO" class="nexos.common.spring.security.UserDAO">
    <property name="sqlMapClientTemplate" ref="sqlMapClientTemplate" />
  </bean>

  <!-- 보안처리 서비스등록 -->
  <bean id="customUserDetailsService" class="nexos.common.spring.security.UserDetailsServiceImpl">
    <property name="userDAO" ref="userDAO" />
  </bean>

  <security:authentication-manager alias="authenticationManager">
    <!-- 보안처리 서비스등록 -->
    <security:authentication-provider user-service-ref="customUserDetailsService" />
  </security:authentication-manager>

  <!-- services 대해 ROLE_USER를 세팅 -->
  <security:global-method-security secured-annotations="enabled">
    <security:protect-pointcut access="ROLE_USER" expression="execution(* nexos.service..*.*(..))" />
  </security:global-method-security>
</beans>